#!/bin/bash
# Transfer parallel optimized pipeline

echo "Transferring parallel optimized pipeline to cluster..."
echo "ğŸš€ NEW FEATURES:"
echo "1. âœ… Parallel download and processing (4 download + 8 processing threads)"
echo "2. âœ… Optimized memory usage (512GB instead of 256GB)"
echo "3. âœ… Enhanced nested archive support (GSE275999 style)"
echo "4. âœ… FTP downloads for faster speed"
echo "5. âœ… No email addresses (cluster-safe)"
echo "6. âœ… 64 CPU cores for maximum performance"
echo "7. âœ… Smart dataset categorization (skip completed, process downloaded-only)"
echo "8. âœ… Real-time status display with threading"
echo "9. âœ… Enhanced error handling and logging"
echo "10. âœ… Thread-safe download tracker"
echo ""

echo "Transferring files..."
scp src/parallel_optimized_pipeline.py ul_oqn09@uc3.scc.kit.edu:~/als_foundation_model/src/
scp scripts/run_parallel_optimized_pipeline.slurm ul_oqn09@uc3.scc.kit.edu:~/als_foundation_model/scripts/
scp configs/streaming_config.json ul_oqn09@uc3.scc.kit.edu:~/als_foundation_model/configs/

echo "Transfer complete!"
echo ""
echo "ğŸš€ READY TO RUN PARALLEL OPTIMIZED PIPELINE!"
echo ""
echo "On the cluster, run:"
echo "  cd ~/als_foundation_model"
echo "  sbatch scripts/run_parallel_optimized_pipeline.slurm"
echo ""
echo "Expected improvements:"
echo "- âš¡ 3-4x faster execution (parallel processing)"
echo "- ğŸ’¾ Better memory utilization (512GB vs 256GB)"
echo "- ğŸ“¥ Faster downloads (FTP protocol)"
echo "- ğŸ”„ Parallel download + processing"
echo "- ğŸ¯ Smart resumption (skip completed, process downloaded-only)"
echo "- ğŸ“Š Real-time status updates"
echo "- ğŸ›¡ï¸ Cluster-safe (no email addresses)"
echo ""
echo "The pipeline will:"
echo "1. ğŸ“Š Read download_tracker.json"
echo "2. ğŸš€ Skip already processed datasets"
echo "3. ğŸ“¥ Download remaining datasets in parallel (4 threads)"
echo "4. ğŸ”„ Process downloaded-but-unprocessed datasets in parallel (8 threads)"
echo "5. ğŸ“¦ Handle nested archives like GSE275999"
echo "6. ğŸ’¾ Use 512GB memory efficiently"
echo "7. âš¡ Run much faster than before!"
